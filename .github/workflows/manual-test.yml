name: Manual Test Runner

on:
  workflow_dispatch:
    inputs:
      platform:
        description: 'Select Platform'
        required: true
        default: 'androidSauce'
        type: choice
        options:
          - androidSauce
          - iOSSauce
          - android
          - ios
      
      test_tag:
        description: 'Test Tag'
        required: true
        default: '@createPin'
        type: choice
        options:
          - '@createPin'
          - '@pinValidationSuccess'
          - '@pinValidationFailed'

jobs:
  test:
    name: Manual Test - ${{ inputs.platform }}
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Display Inputs
      run: |
        echo "==========================="
        echo "ðŸŽ¯ Manual Test Execution"
        echo "==========================="
        echo "Platform: ${{ inputs.platform }}"
        echo "Test Tag: ${{ inputs.test_tag }}"
        echo "Branch: ${{ github.ref_name }}"
        echo "Triggered by: ${{ github.actor }}"
        echo "==========================="
    
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven
    
    - name: Run Tests
      run: |
        echo "ðŸ§ª Running tests with parameters:"
        echo "Platform: ${{ inputs.platform }}"
        echo "Tags: ${{ inputs.test_tag }}"
        
        mvn clean test \
          -Dplatform=${{ inputs.platform }} \
          -Dcucumber.filter.tags="${{ inputs.test_tag }}" \
          -DfailIfNoTests=false
      env:
        SAUCELABS_USERNAME: ${{ secrets.SAUCELABS_USERNAME }}
        SAUCELABS_ACCESS_KEY: ${{ secrets.SAUCELABS_ACCESS_KEY }}
